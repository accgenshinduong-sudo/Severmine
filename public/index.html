<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üéÆ Minecraft Server Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/utilities.css">
</head>
<body>
    <!-- Disconnect Overlay -->
    <div class="disconnect-overlay" id="disconnectOverlay">
        <div class="disconnect-card">
            <div class="spinner"></div>
            <h2>M·∫•t k·∫øt n·ªëi!</h2>
            <p>ƒêang k·∫øt n·ªëi l·∫°i v·ªõi server...</p>
        </div>
    </div>

    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-card">
            <div class="login-icon">üéÆ</div>
            <h1>Minecraft Server Panel</h1>
            <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω server c·ªßa b·∫°n</p>
            <div class="login-input-wrapper">
                <div class="login-input-icon">üîí</div>
                <input type="password" class="login-input" id="loginPass" placeholder="Nh·∫≠p m·∫≠t kh·∫©u..." autocomplete="off">
            </div>
            <button class="login-btn" id="loginBtn"><span>üîì ƒêƒÉng Nh·∫≠p</span></button>
            <p class="login-error" id="loginError">‚ùå M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Main App -->
    <div class="app">
        <!-- Header -->
        <header class="header" id="header">
            <div class="header-left">
                <div class="header-logo">üéÆ</div>
                <div class="header-info">
                    <h1 id="serverName">Minecraft Server</h1>
                    <div class="header-status">
                        <div class="status-dot" id="statusDot"></div>
                        <span id="statusText">ƒêang t·∫£i...</span>
                    </div>
                </div>
            </div>
            <div class="header-actions">
                <button class="header-btn" id="btnStart" title="Kh·ªüi ƒë·ªông"><i class="fas fa-play"></i></button>
                <button class="header-btn" id="btnRestart" title="Restart"><i class="fas fa-redo"></i></button>
                <button class="header-btn danger" id="btnStop" title="D·ª´ng"><i class="fas fa-stop"></i></button>
            </div>
        </header>

        <div class="page-container">
            <!-- ========== DASHBOARD ========== -->
            <div class="page active" id="page-home">
                <h2 class="page-title"><span class="page-title-icon">üìä</span>T·ªïng Quan</h2>
                
                <div class="stats-grid">
                    <div class="stat-card highlight">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-value" id="playerCount">0</div>
                        <div class="stat-label">Ng∆∞·ªùi ch∆°i</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è±Ô∏è</div>
                        <div class="stat-value" id="serverUptime">--</div>
                        <div class="stat-label">Th·ªùi gian</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üíª</div>
                        <div class="stat-value" id="cpuUsage">0%</div>
                        <div class="stat-label">CPU</div>
                        <div class="stat-bar"><div class="stat-bar-fill" id="cpuBar"></div></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üß†</div>
                        <div class="stat-value" id="memUsage">0%</div>
                        <div class="stat-label">RAM</div>
                        <div class="stat-bar"><div class="stat-bar-fill" id="memBar"></div></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header"><span class="card-title">‚ö° L·ªánh Nhanh</span></div>
                    <div class="card-body">
                        <div class="quick-actions">
                            <button class="quick-btn" onclick="cmd('list')"><span class="icon">üë•</span>Danh s√°ch</button>
                            <button class="quick-btn" onclick="cmd('save-all')"><span class="icon">üíæ</span>L∆∞u</button>
                            <button class="quick-btn" onclick="cmd('time set day')"><span class="icon">‚òÄÔ∏è</span>Ng√†y</button>
                            <button class="quick-btn" onclick="cmd('time set night')"><span class="icon">üåô</span>ƒê√™m</button>
                            <button class="quick-btn" onclick="cmd('weather clear')"><span class="icon">üå§Ô∏è</span>Quang</button>
                            <button class="quick-btn" onclick="cmd('weather rain')"><span class="icon">üåßÔ∏è</span>M∆∞a</button>
                            <button class="quick-btn" onclick="cmd('difficulty peaceful')"><span class="icon">üòá</span>Peaceful</button>
                            <button class="quick-btn danger" onclick="cmd('stop')"><span class="icon">üõë</span>D·ª´ng</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <span class="card-title">üë• Ng∆∞·ªùi Ch∆°i Online</span>
                        <button class="cmd-chip" onclick="cmd('list')"><i class="fas fa-sync-alt"></i></button>
                    </div>
                    <div class="card-body">
                        <div id="dashPlayers"><div class="no-data"><div class="no-data-text">Kh√¥ng c√≥ ng∆∞·ªùi ch∆°i online</div></div></div>
                    </div>
                </div>
            </div>

            <!-- ========== CONSOLE ========== -->
            <div class="page" id="page-console">
                <h2 class="page-title"><span class="page-title-icon">üñ•Ô∏è</span>Console</h2>

                <div class="card" style="margin-bottom:16px">
                    <div class="card-body">
                        <div class="cmd-chips">
                            <button class="cmd-chip" onclick="cmd('help')"><i class="fas fa-question-circle"></i> Help</button>
                            <button class="cmd-chip" onclick="cmd('list')"><i class="fas fa-users"></i> List</button>
                            <button class="cmd-chip" onclick="cmd('save-all')"><i class="fas fa-save"></i> Save</button>
                            <button class="cmd-chip" onclick="promptCmd('op')"><i class="fas fa-crown"></i> OP</button>
                            <button class="cmd-chip" onclick="promptCmd('deop')"><i class="fas fa-user"></i> DeOP</button>
                            <button class="cmd-chip" onclick="promptTp()"><i class="fas fa-map-marker-alt"></i> TP</button>
                            <button class="cmd-chip danger" onclick="promptCmd('kick')"><i class="fas fa-ban"></i> Kick</button>
                            <button class="cmd-chip danger" onclick="promptCmd('ban')"><i class="fas fa-gavel"></i> Ban</button>
                        </div>
                    </div>
                </div>

                <div class="console-box">
                    <div class="console-output" id="console"></div>
                    <div class="console-input-row">
                        <input type="text" class="console-input" id="consoleInput" placeholder="Nh·∫≠p l·ªánh Minecraft...">
                        <button class="console-send" onclick="sendConsole()"><i class="fas fa-paper-plane"></i> G·ª≠i</button>
                    </div>
                </div>
            </div>

            <!-- ========== PLAYERS ========== -->
            <div class="page" id="page-players">
                <h2 class="page-title"><span class="page-title-icon">üë•</span>Ng∆∞·ªùi Ch∆°i (<span id="onlineCount">0</span>)</h2>
                <div class="player-list" id="playerList"><div class="no-data"><div class="no-data-text">Kh√¥ng c√≥ ng∆∞·ªùi ch∆°i online</div></div></div>

                <div class="card" style="margin-top:20px">
                    <div class="card-header"><span class="card-title">‚õî Qu·∫£n L√Ω L·ªánh C·∫•m</span></div>
                    <div class="card-body">
                        <div class="cmd-chips">
                            <button class="cmd-chip" onclick="cmd('banlist')"><i class="fas fa-list"></i> Danh s√°ch</button>
                            <button class="cmd-chip" onclick="promptCmd('pardon')"><i class="fas fa-check-circle"></i> B·ªè c·∫•m</button>
                            <button class="cmd-chip" onclick="promptCmd('ban-ip')"><i class="fas fa-network-wired"></i> C·∫•m IP</button>
                            <button class="cmd-chip" onclick="cmd('whitelist list')"><i class="fas fa-clipboard-list"></i> Whitelist</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== ITEMS ========== -->
            <div class="page" id="page-items">
                <h2 class="page-title"><span class="page-title-icon">üéÅ</span>V·∫≠t Ph·∫©m</h2>
                <div id="itemsContainer"></div>

                <div class="give-panel" id="givePanel">
                    <div class="give-panel-title">üéÅ C·∫•p v·∫≠t ph·∫©m: <span id="selectedItemName">Ch∆∞a ch·ªçn</span></div>
                    <div class="give-panel-row">
                        <select id="givePlayer"><option value="">Ch·ªçn ng∆∞·ªùi ch∆°i</option></select>
                        <input type="number" id="giveAmount" value="1" min="1" max="64" placeholder="S·ªë l∆∞·ª£ng">
                    </div>
                    <button class="give-panel-btn" onclick="giveSelectedItem()"><i class="fas fa-gift"></i> C·∫•p V·∫≠t Ph·∫©m</button>
                </div>

                <div class="card" style="margin-top:20px">
                    <div class="card-header"><span class="card-title">üì¶ V·∫≠t Ph·∫©m T√πy Ch·ªânh</span></div>
                    <div class="card-body">
                        <div style="display:flex;flex-direction:column;gap:12px">
                            <input type="text" id="customItem" placeholder="ID v·∫≠t ph·∫©m (vd: diamond, minecraft:iron_ingot)" style="padding:16px;background:var(--bg-secondary);border:1px solid var(--border);border-radius:10px;font-size:14px;color:var(--text-primary)">
                            <button class="btn btn-primary" onclick="giveCustomItem()"><i class="fas fa-gift"></i> C·∫•p V·∫≠t Ph·∫©m</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== MAP ========== -->
            <div class="page" id="page-map">
                <h2 class="page-title"><span class="page-title-icon">üó∫Ô∏è</span>B·∫£n ƒê·ªì T·ªça ƒê·ªô</h2>
                <div class="map-wrapper">
                    <div class="map-toolbar">
                        <button class="cmd-chip" onclick="centerMap()"><i class="fas fa-crosshairs"></i> Spawn</button>
                        <button class="cmd-chip" onclick="fitAllPlayers()"><i class="fas fa-users"></i> T·∫•t c·∫£</button>
                        <button class="cmd-chip" onclick="CoordMap.render()"><i class="fas fa-sync-alt"></i> Refresh</button>
                    </div>
                    <div class="coord-map-container">
                        <canvas id="coordCanvas"></canvas>
                        <div id="playerInfoBox" class="player-info-box"></div>
                    </div>
                    <div class="map-controls">
                        <button class="map-control-btn" onclick="zoomInMap()"><i class="fas fa-plus"></i></button>
                        <button class="map-control-btn" onclick="zoomOutMap()"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="map-overlay map-info">Zoom: <span id="mapZoom">100%</span></div>
                    <div class="map-overlay map-coords" id="mapCoords">X: 0, Z: 0</div>
                </div>
                <div class="card" style="margin-top:20px">
                    <div class="card-header"><span class="card-title">üìç V·ªã Tr√≠ Ng∆∞·ªùi Ch∆°i</span></div>
                    <div class="card-body"><div id="mapPlayerList"><div class="no-data"><div class="no-data-text">Kh√¥ng c√≥ ng∆∞·ªùi ch∆°i online</div></div></div></div>
                </div>
            </div>

            <!-- ========== UPLOAD ========== -->
            <div class="page" id="page-upload">
                <h2 class="page-title"><span class="page-title-icon">üì§</span>Upload Files</h2>
                
                <div class="upload-stats" id="uploadStats"></div>

                <div class="card">
                    <div class="card-header">
                        <span class="card-title">üìÅ Danh s√°ch file</span>
                        <button class="cmd-chip" onclick="Upload.openUploadDialog()"><i class="fas fa-plus"></i> Upload</button>
                    </div>
                    <div class="card-body">
                        <div class="upload-dropzone" id="uploadDropzone" onclick="Upload.openUploadDialog()">
                            <div class="upload-dropzone-icon">üì§</div>
                            <div class="upload-dropzone-text">K√©o th·∫£ file v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</div>
                            <div class="upload-dropzone-hint">H·ªó tr·ª£: .jar, .zip, .json, .yml, .properties (t·ªëi ƒëa 100MB)</div>
                        </div>
                        <div class="upload-file-list" id="uploadFileList"></div>
                    </div>
                </div>

                <div class="card" style="margin-top:20px">
                    <div class="card-header"><span class="card-title">‚ÑπÔ∏è H∆∞·ªõng d·∫´n</span></div>
                    <div class="card-body">
                        <div class="info-text">
                            <p><strong>üîß Mods:</strong> Upload file .jar v√†o th∆∞ m·ª•c mods/</p>
                            <p><strong>üîå Plugins:</strong> Upload file .jar v√†o th∆∞ m·ª•c plugins/</p>
                            <p><strong>üì¶ Datapacks:</strong> Upload file .zip v√†o world/datapacks/</p>
                            <p><strong>‚öôÔ∏è Config:</strong> Upload file c·∫•u h√¨nh v√†o config/</p>
                            <p><strong>üé® Resource Packs:</strong> Upload file .zip v√†o resourcepacks/</p>
                            <p style="color:var(--warning);margin-top:10px">‚ö†Ô∏è C·∫ßn restart server sau khi upload mods/plugins m·ªõi!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== BROADCAST ========== -->
            <div class="page" id="page-broadcast">
                <h2 class="page-title"><span class="page-title-icon">üì¢</span>Th√¥ng B√°o</h2>
                <div class="broadcast-input-area">
                    <input type="text" class="broadcast-input" id="broadcastMsg" placeholder="Nh·∫≠p n·ªôi dung th√¥ng b√°o...">
                    <div class="broadcast-btns">
                        <button class="broadcast-btn" onclick="sendBroadcast()"><i class="fas fa-bullhorn"></i> G·ª≠i</button>
                        <button class="broadcast-btn" onclick="sendTitle()"><i class="fas fa-film"></i> Title</button>
                        <button class="broadcast-btn" onclick="sendChat()"><i class="fas fa-comment-alt"></i> Chat</button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header"><span class="card-title">‚ö° Th√¥ng B√°o Nhanh</span></div>
                    <div class="card-body">
                        <div class="cmd-chips">
                            <button class="cmd-chip" onclick="quickBroadcast('Server restart sau 5 ph√∫t!')"><i class="fas fa-redo"></i> Restart 5p</button>
                            <button class="cmd-chip" onclick="quickBroadcast('Ch√†o m·ª´ng ƒë·∫øn server!')"><i class="fas fa-hand-wave"></i> Ch√†o m·ª´ng</button>
                            <button class="cmd-chip" onclick="quickBroadcast('S·ª± ki·ªán ƒëang di·ªÖn ra!')"><i class="fas fa-party-horn"></i> S·ª± ki·ªán</button>
                            <button class="cmd-chip danger" onclick="quickBroadcast('C·∫¢NH B√ÅO: Vi ph·∫°m s·∫Ω b·ªã ban!')"><i class="fas fa-exclamation-triangle"></i> C·∫£nh b√°o</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== FILES ========== -->
            <div class="page" id="page-files">
                <h2 class="page-title"><span class="page-title-icon">üìÅ</span>T·ªáp Tin</h2>
                <div class="card" style="padding:0">
                    <div class="file-header" id="filePath"></div>
                    <div class="file-list" id="fileList"></div>
                </div>
            </div>

            <!-- ========== SETTINGS ========== -->
            <div class="page" id="page-settings">
                <h2 class="page-title"><span class="page-title-icon">‚öôÔ∏è</span>C√†i ƒê·∫∑t</h2>

                <div class="settings-section">
                    <div class="settings-title">ƒêi·ªÅu khi·ªÉn Server</div>
                    <div class="settings-grid">
                        <button class="settings-btn" onclick="WS.send({action:'start'})"><span class="icon"><i class="fas fa-play"></i></span> Kh·ªüi ƒë·ªông</button>
                        <button class="settings-btn" onclick="WS.send({action:'restart'})"><span class="icon"><i class="fas fa-redo"></i></span> Restart</button>
                        <button class="settings-btn danger" onclick="WS.send({action:'stop'})"><span class="icon"><i class="fas fa-stop"></i></span> D·ª´ng</button>
                        <button class="settings-btn danger" onclick="if(confirm('Bu·ªôc d·ª´ng?'))WS.send({action:'kill'})"><span class="icon"><i class="fas fa-skull"></i></span> Bu·ªôc d·ª´ng</button>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-title">Game Rules</div>
                    <div class="settings-grid">
                        <button class="settings-btn" onclick="cmd('save-all')"><span class="icon"><i class="fas fa-save"></i></span> L∆∞u th·∫ø gi·ªõi</button>
                        <button class="settings-btn" onclick="cmd('whitelist on')"><span class="icon"><i class="fas fa-check-circle"></i></span> B·∫≠t whitelist</button>
                        <button class="settings-btn" onclick="cmd('whitelist off')"><span class="icon"><i class="fas fa-times-circle"></i></span> T·∫Øt whitelist</button>
                        <button class="settings-btn" onclick="cmd('gamerule keepInventory true')"><span class="icon"><i class="fas fa-suitcase"></i></span> Gi·ªØ ƒë·ªì: B·∫¨T</button>
                        <button class="settings-btn" onclick="cmd('gamerule keepInventory false')"><span class="icon"><i class="fas fa-suitcase"></i></span> Gi·ªØ ƒë·ªì: T·∫ÆT</button>
                        <button class="settings-btn" onclick="cmd('gamerule doDaylightCycle false')"><span class="icon"><i class="fas fa-clock"></i></span> D·ª´ng th·ªùi gian</button>
                        <button class="settings-btn" onclick="cmd('gamerule doMobSpawning false')"><span class="icon"><i class="fas fa-ghost"></i></span> T·∫Øt mob</button>
                        <button class="settings-btn" onclick="cmd('gamerule doMobSpawning true')"><span class="icon"><i class="fas fa-ghost"></i></span> B·∫≠t mob</button>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-title">Th√¥ng Tin H·ªá Th·ªëng</div>
                    <div class="info-card">
                        <div class="info-row"><span class="info-label">N·ªÅn t·∫£ng</span><span class="info-value" id="infoPlatform">--</span></div>
                        <div class="info-row"><span class="info-label">Hostname</span><span class="info-value" id="infoHostname">--</span></div>
                        <div class="info-row"><span class="info-label">CPU Cores</span><span class="info-value" id="infoCores">--</span></div>
                        <div class="info-row"><span class="info-label">T·ªïng RAM</span><span class="info-value" id="infoRAM">--</span></div>
                        <div class="info-row"><span class="info-label">Th∆∞ m·ª•c</span><span class="info-value" id="infoDir" style="font-size:12px">--</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <div class="nav-item active" data-page="home"><span class="icon"><i class="fas fa-home"></i></span><span>T·ªïng quan</span></div>
            <div class="nav-item" data-page="console"><span class="icon"><i class="fas fa-terminal"></i></span><span>Console</span></div>
            <div class="nav-item-wrapper">
                <div class="nav-item" data-page="players"><span class="icon"><i class="fas fa-users"></i></span><span>Ng∆∞·ªùi ch∆°i</span></div>
                <span class="nav-badge" id="playerBadge">0</span>
            </div>
            <div class="nav-item" data-page="items"><span class="icon"><i class="fas fa-gift"></i></span><span>V·∫≠t ph·∫©m</span></div>
            <div class="nav-item" data-page="more"><span class="icon"><i class="fas fa-ellipsis-h"></i></span><span>Th√™m</span></div>
        </nav>
    </div>

    <!-- More Menu Modal -->
    <div class="modal-overlay" id="moreModal">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title">T√≠nh nƒÉng kh√°c</span>
                <button class="modal-close" onclick="closeMoreModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="settings-grid">
                    <button class="settings-btn full" onclick="switchPage('map');closeMoreModal()"><span class="icon"><i class="fas fa-map"></i></span> B·∫£n ƒë·ªì</button>
                    <button class="settings-btn full" onclick="switchPage('upload');closeMoreModal()"><span class="icon"><i class="fas fa-upload"></i></span> Upload Mods</button>
                    <button class="settings-btn full" onclick="switchPage('broadcast');closeMoreModal()"><span class="icon"><i class="fas fa-bullhorn"></i></span> Th√¥ng b√°o</button>
                    <button class="settings-btn full" onclick="switchPage('files');closeMoreModal()"><span class="icon"><i class="fas fa-folder"></i></span> T·ªáp tin</button>
                    <button class="settings-btn full" onclick="switchPage('settings');closeMoreModal()"><span class="icon"><i class="fas fa-cog"></i></span> C√†i ƒë·∫∑t</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Editor Modal -->
    <div class="modal-overlay" id="editorModal">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title" id="editorTitle">Ch·ªânh s·ª≠a t·ªáp</span>
                <button class="modal-close" onclick="closeEditor()">√ó</button>
            </div>
            <div class="modal-body">
                <textarea class="editor-textarea" id="editor" spellcheck="false"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditor()"><i class="fas fa-times"></i> H·ªßy</button>
                <button class="btn btn-primary" onclick="saveFile()"><i class="fas fa-save"></i> L∆∞u</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/app.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/console.js"></script>
    <script src="js/players.js"></script>
    <script src="js/items.js"></script>
    <script src="js/files.js"></script>
    <script src="js/broadcast.js"></script>
    <script src="js/coordmap.js"></script>
    <script src="js/upload.js"></script>
</body>
</html>
